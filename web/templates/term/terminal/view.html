{% extends "term/page.html" %}

{% block content %}
<span ng-init="term.id={{term.id}};term.status={{term.status}}"></span>
<h2 class="g-color-blue m-page-name">
    <div ng-controller="TerminalController">
        {{term.name}}
        {% if term_access %}
        <div class="right">
            <a ng-show="term.status" 
                ng-click="lockingTerminal(term)" 
                class="f-spot-button small">
                Заблокировать
            </a>
            <a ng-hide="term.status" 
                ng-click="lockingTerminal(term)" 
                class="f-spot-button small">
                Разблокировать
            </a>
<!--             <a ng-click="removeTerminal(term)" 
                class="f-spot-button bg-red small">
                Удалить
            </a> -->
        </div>
        {% endif %}
    </div>
    <div class="block-nav">
        <a href="/terminal">Терминалы</a>
        <span>{{term.id}}, {{term.name}}</span>
    </div>
</h2>
<div class="section-container section-container__main auto" data-section="" data-options="deep_linking: true;" style="" ng-controller="TerminalController">
    <section class="section active">
        <p class="title"><a>Информация</a></p>
        <div class="content">
            <div class="content-wrap content-separation">
                <div class="content-row right">
                    <h6>Последние сеансы связи:</h6>
                    <table class="m-session-table">
                        <tr>
                            <td>Загрузка отчета</td>
                            <td>{{term.report_date|replace("None", "не было")}}</td>
                        </tr>
                        <tr>
                            <td>Загрузка настроек</td>
                            <td>{{term.config_date|replace("None", "не было")}}</td>
                        </tr>
                        <tr>
                            <td>Загрузка черного списка</td>
                            <td> {{term.blacklist_date|replace("None", "не было")}}</td>
                        </tr>
                    </table>
                </div>
                <div class="content-row row-separation-l">
                    <p class="m-hint">Для изменения события кликните по соотвествующей строке в таблице</p>
                </div>
                {% if term_access %}
                <div class="content-row f-main-slide-link">
                    <div class="toggle-active">
                        <a id="event" class="loc-link f-spot-button small">
                            + Добавить событие
                        </a>
                        
                    </div>
                </div>
                {% endif %}
                <div id="eventForm" class="slide-box slide-setting">
                    {% include 'term/terminal/event_form.html' %}
                </div>
                <table class="m-spot-table">
                    <thead>
                    <tr>
                        <th><span>Событие</span></th>
                        <th>Начало</th>
                        <th>Конец</th>
                        <th>Стоимость</th>
                    </tr>
                    </thead>
                    <tbody>
                        {% for term_event in term_events %}
                        <tr 
                            {% if term_access %}
                                ng-click="getTermEventEdit({{term_event.term_id}}, {{term_event.id}})"
                            {% endif %}
                            class="m-t-cont-row">
                            <td>{{term_event.event.name}}</td>
                            <td>{{term_event.start}}</td>
                            <td>{{term_event.stop}}</td>
                            <td>{{term_event.cost}}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>

    </section>
    {% if term_access %}
    <section class="section">
        <p class="title">
            <a>Редактировать</a>
        </p>
        <div class="content">
            {% include 'term/terminal/form.html' %}
        </div>
    </section>
    {% endif %}
</div>
{% endblock %}
{% block footer_script %}
<script type="text/javascript" src="/static/term/angular/term/controllers/terminal.js"></script> 
{{ super() }}
{% endblock %} 